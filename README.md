code based off https://pdfs.semanticscholar.org/75d7/5a3fe7796fe9b3003ea73252de58d93d60dc.pdf
